<div class="card">
  <div class="card-content">
    <div class="media">
      <div class="media-left">
        <figure class="image is-48x48">
          <%= image_tag 'placeholder.png', alt: 'Placeholder image' %>
        </figure>
      </div>
      <div class="media-content">
        <p class="title is-4 mb-0">
          <%= link_to post.user.full_name, post.user %>
          <% if current_user != post.user && !current_user.friend?(post.user) && !current_user.friend_request?(post.user) %>
            <%= link_to new_friend_request_path(candidate: post.user.id), class: 'has-text-primary', title: 'Send Friend Request' do |f| %>
              <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                <path fill="currentColor" d="M19 17V19H7V17S7 13 13 13 19 17 19 17M16 8A3 3 0 1 0 13 11A3 3 0 0 0 16 8M19.2 13.06A5.6 5.6 0 0 1 21 17V19H24V17S24 13.55 19.2 13.06M18 5A2.91 2.91 0 0 0 17.11 5.14A5 5 0 0 1 17.11 10.86A2.91 2.91 0 0 0 18 11A3 3 0 0 0 18 5M8 10H5V7H3V10H0V12H3V15H5V12H8Z" />
              </svg>
            <% end %>
          <% end %>
        </p>
        <time class="subtitle is-7">
          <%= distance_of_time_in_words(Time.now, post.created_at) %> ago
          <% if post.edited? %>
            <span class="is-danger">(edited <%= distance_of_time_in_words(Time.now, post.updated_at) %> ago)</span>
          <% end %>
        </time>
      </div>
      <div class="media-right">
        <div class="dropdown is-hoverable">
          <div class="dropdown-trigger">
            <button class="button">...</button>
          </div>
          <div class="dropdown-menu">
            <div class="dropdown-content">
              <% if current_user != post.user %>
                <div>
                  <% if like.new_record? %>
                    <%= form_with(url: likes_path(likeable: { likeable_type: 'Post', likeable_id: post.id }, path: request.path)) do |f| %>
                      <%= f.submit 'Like', class: 'dropdown-submit button dropdown-item has-text-left' %>
                    <% end %>
                  <% else %>
                    <%= form_with(url: like_path(like, path: request.path), method: :delete) do |f| %>
                      <%= f.submit 'Unlike', class: 'dropdown-submit button dropdown-item has-text-left' %>
                    <% end %>
                  <% end %>
                </div>
              <% end %>
              <%= link_to 'Share', '#', class: 'dropdown-item' %>
              <% if current_user == post.user %>
                <hr class="dropdown-divider">
                <%= link_to 'Edit', edit_post_path(post), class: 'dropdown-item', data: { turbo_frame: "post_#{post.id}" } %>
                <div>
                  <%= form_with(model: post, method: :delete) do |f| %>
                    <%= f.submit 'Delete', class: 'dropdown-submit button dropdown-item has-text-left' %>
                  <% end %>
                </div>
              <% end %> 
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="content">
      <%= turbo_frame_tag post do %>
        <p class="post-content"><%= post.content %></p>
      <% end %>
        <div class="columns is-justify-content-space-between is-align-items-center mt-2">
          <div class="column pb-0">
            <%= link_to "#{post.comments.length} Comments", post %>
          </div>
          <div class="column pb-0 has-text-right">
            <i><%= pluralize(post.likes.length, 'person') %> <span class="is-size-4 has-text-danger">â™¥</span> this post</i>
          </div>
        </div>
      </div>
      <footer class="card-footer">
        <% if %w[ posts comments ].none?(controller_name) %>
          <%= link_to 'Show', post, class: 'card-footer-item button is-success' %>
        <% end %>
      </footer>
    </div>
  </div>
</div>
